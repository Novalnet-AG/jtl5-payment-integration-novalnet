function fillMerchantConfiguration(){transactionRequestHandler({nn_public_key:jQuery("input[name=novalnet_public_key]").val(),nn_private_key:jQuery("input[name=novalnet_private_key]").val(),nn_request_type:"autofill"})}function transactionRequestHandler(e){var n=jQuery("input[id=nn_post_url]").val();if("XDomainRequest"in window&&null!==window.XDomainRequest){var a=new XDomainRequest,t=jQuery.param(e);a.open("GET",n+t),a.onload=function(){autofillMerchantDetails(this.responseText)},a.onerror=function(){_result=!1},a.send()}else jQuery.ajax({url:n,type:"post",dataType:"html",data:e,global:!1,async:!1,success:function(e){autofillMerchantDetails(e)}})}function autofillMerchantDetails(e){var n=jQuery.parseJSON(e);if("SUCCESS"!=n.result.status)return jQuery('input[name="novalnet_public_key"],input[name="novalnet_private_key"]').val(""),jQuery(".content-header").prepend('<div class="alert alert-danger align-items-center"><i class="fal fa-info-circle mr-2"></i>'+n.result.status_text+"</div>"),jQuery("#novalnet_tariffid").val(""),!1;var a=Object.keys(n.merchant.tariff),t=jQuery("#novalnet_tariffid").val();try{var r=decodeURIComponent(escape("Auswählen"))}catch(e){r="Auswählen"}jQuery("#novalnet_tariffid").replaceWith('<select id="novalnet_tariffid" class="form-control combo" name="novalnet_tariffid"><option value="" disabled>'+r+"</option></select>"),jQuery("#novalnet_tariffid").find("option").remove();for(var l=0;l<a.length;l++)void 0!==a[l]&&jQuery("#novalnet_tariffid").append(jQuery("<option>",{value:jQuery.trim(a[l])+"-"+jQuery.trim(n.merchant.tariff[a[l]].type),text:jQuery.trim(n.merchant.tariff[a[l]].name)})),t==jQuery.trim(a[l])+"-"+jQuery.trim(n.merchant.tariff[a[l]].type)&&jQuery("#novalnet_tariffid").val(jQuery.trim(a[l])+"-"+jQuery.trim(n.merchant.tariff[a[l]].type));jQuery("#novalnet_client_key").val(n.merchant.client_key)}function configureWebhookUrlAdminPortal(){var e={nn_public_key:jQuery("input[name=novalnet_public_key]").val(),nn_private_key:jQuery("input[name=novalnet_private_key]").val(),nn_webhook_url:jQuery("input[name=novalnet_webhook_url]").val(),nn_request_type:"configureWebhook"};webhookRequestParams=e;var n=jQuery("input[id=nn_post_url]").val();if("XDomainRequest"in window&&null!==window.XDomainRequest){var a=new XDomainRequest,t=jQuery.param(webhookRequestParams);a.open("GET",n+t),a.onload=function(){updateWebhookStatus(result)},a.onerror=function(){_result=!1},a.send()}else jQuery.ajax({url:n,type:"post",dataType:"html",data:webhookRequestParams,global:!1,async:!1,success:function(e){updateWebhookStatus(e)}})}function updateWebhookStatus(e){var n=jQuery.parseJSON(e);"SUCCESS"==n.result.status?alert(jQuery("input[name=nn_webhook_success]").val()):alert(n.result.status_text)}function handleErrorElement(e,n,a){event.preventDefault(),jQuery(e).css("border","2px solid red"),alert(n),jQuery("html, body").animate({scrollTop:e.offset().top-160},500,(function(){!1!==a&&jQuery(e).parent().addClass("set_error"),jQuery(".set_error").length&&"none"==jQuery(".set_error").parent().parent().css("display")&&jQuery(".set_error").parent().parent().parent().find(".subheading1").click(),"none"==jQuery(e).parent().closest("div").css("display")&&jQuery(this).css("display","block")}))}jQuery(document).ready((function(){""==jQuery("#novalnet_googlepay_seller_name").val()&&jQuery("#novalnet_googlepay_seller_name").val(jQuery("#nn_shop_name").val()),""==jQuery("#novalnet_applepay_seller_name").val()&&jQuery("#novalnet_applepay_seller_name").val(jQuery("#nn_shop_name").val()),jQuery("#novalnet_googlepay_country_code").attr({minlength:2,maxlength:2}),jQuery("#novalnet_googlepay_country_code").on("input",(function(e){let n=jQuery(this).val().replace(/[^A-Z]+/g,"").replace(/\s+/g,"");jQuery(this).val(n)})),""==jQuery("#novalnet_cc_accepted_card_types").val()&&jQuery("#novalnet_cc_accepted_card_types option").each((function(){var e=jQuery(this).val();jQuery("#novalnet_cc_accepted_card_types option[value="+e+"]").attr("selected",!0)})),jQuery.each(["#novalnet_applepay_button_display","#novalnet_googlepay_button_display"],(function(e,n){""==jQuery(n).val()&&jQuery(n+" option").each((function(){var e=jQuery(this).val();jQuery(n+" option[value="+e+"]").attr("selected",!0)}))})),jQuery.each(["#novalnet_instalment_invoice_cycles","#novalnet_instalment_sepa_cycles"],(function(e,n){"de-DE"!=jQuery("#nn_shop_lang").val()&&jQuery(n+" option").each((function(){jQuery(this).text(jQuery(this).html().replace(/\bZyklen\b/g,"Cycle"))})),""==jQuery(n).val()&&jQuery(n+" option").each((function(){jQuery(this).val()<=36&&jQuery(n+" option[value="+jQuery(this).val()+"]").attr("selected",!0)}))})),jQuery.each(["#novalnet_cc_accepted_card_types","#novalnet_instalment_invoice_cycles","#novalnet_instalment_sepa_cycles"],(function(e,n){jQuery(n).on("change",(function(){jQuery(n+" option:selected").length||handleErrorElement(jQuery(n),jQuery("#nn_multiselect_text").val())}))}));var e=jQuery(".tab-content").children()[2];jQuery(e).find("[class*=subheading]").append('<i class="fa fa-chevron-circle-down nn_fa"></i>'),jQuery(e).find(".mb-3").hover((function(){jQuery(this).css("cursor","pointer")})),jQuery.each(["cc","sepa","invoice","paypal","guaranteed_invoice","guaranteed_sepa","instalment_invoice","instalment_sepa","googlepay","applepay"],(function(n,a){0==jQuery(e).find("#novalnet_"+a+"_payment_action").val()&&jQuery(e).find("#novalnet_"+a+"_manual_check_limit").parent().parent().hide(),jQuery(e).find("#novalnet_"+a+"_payment_action").on("change",(function(n){0==jQuery(e).find("#novalnet_"+a+"_payment_action").val()?jQuery(e).find("#novalnet_"+a+"_manual_check_limit").parent().parent().hide():jQuery(e).find("#novalnet_"+a+"_manual_check_limit").parent().parent().show()}))})),jQuery("#novalnet_sepa_due_date, #novalnet_invoice_due_date, #novalnet_prepayment_due_date, #novalnet_guaranteed_invoice_min_amount, #novalnet_guaranteed_sepa_min_amount, #novalnet_instalment_invoice_min_amount, #novalnet_instalment_sepa_min_amount").parent().on("change",(function(){jQuery(this).hasClass("set_error")&&jQuery(this).removeClass("set_error")})),jQuery(".nn_fa").each((function(){jQuery(this).parent().addClass("nn-toggle-heading"),jQuery(this).parent().next().next().addClass("nn-toggle-content")})),jQuery(".nn-toggle-content").hide(),jQuery(".nn-toggle-heading").on("click",(function(){jQuery(this).next().next().toggle(700),jQuery(this).children("i").hasClass("fa-chevron-circle-down")?jQuery(this).children("i").addClass("fa-chevron-circle-up").removeClass("fa-chevron-circle-down"):jQuery(this).children("i").addClass("fa-chevron-circle-down").removeClass("fa-chevron-circle-up")})),jQuery("input[id=novalnet_client_key]").parent().parent(".form-group").addClass("hide_client_key"),jQuery(".hide_client_key").hide(),null==jQuery("#novalnet_tariffid").val()&&jQuery("input[name=novalnet_tariffid]").attr("id","novalnet_tariffid"),""==jQuery("input[name=novalnet_public_key]").val()&&""==jQuery("input[name=novalnet_private_key]").val()&&jQuery(".content-header").prepend('<div class="alert alert-info"><i class="fal fa-info-circle"></i> '+jQuery("input[name=nn_lang_notification]").val()+"</div>"),null!=jQuery("input[name=novalnet_public_key]").val()&&""!=jQuery("input[name=novalnet_public_key]").val()?fillMerchantConfiguration():""==jQuery("input[name=novalnet_public_key]").val()&&jQuery("#novalnet_tariffid").val(""),jQuery("input[name=novalnet_public_key], input[name=novalnet_private_key]").on("change",(function(){""!=jQuery("input[name=novalnet_public_key]").val()&&""!=jQuery("input[name=novalnet_private_key]").val()?fillMerchantConfiguration():jQuery("#novalnet_tariffid").val("")})),jQuery("input[name=novalnet_webhook_url]").val(jQuery("#nn_webhook_url").val());let n=jQuery("input[name=nn_webhook_change]").val();jQuery("#novalnet_webhook_url").parent().parent().after('<div class="row"><div class="ml-auto col-sm-6 col-xl-auto nn_webhook_button"><button name="nn_webhook_configure" id="nn_webhook_configure_button" class="btn btn-primary btn-block">'+jQuery("input[name=nn_webhook_configure]").val()+"</button></div></div>"),jQuery("#nn_webhook_configure_button").on("click",(function(){null!=jQuery("#novalnet_webhook_url").val()&&""!=jQuery("#novalnet_webhook_url").val()?1==confirm(n)?configureWebhookUrlAdminPortal():location.reload():alert(jQuery("input[name=nn_webhook_invalid]").val())})),jQuery("button[name=speichern]").on("click",(function(e){jQuery.each(["#novalnet_sepa_due_date"],(function(e,n){""!=jQuery.trim(jQuery(n).val())&&(isNaN(jQuery(n).val())||jQuery(n).val()<2||jQuery(n).val()>14)&&handleErrorElement(jQuery(n),jQuery("#nn_invalid_due_date").val())})),""!=jQuery.trim(jQuery("#novalnet_invoice_due_date").val())&&(isNaN(jQuery("#novalnet_invoice_due_date").val())||jQuery("#novalnet_invoice_due_date").val()<7)&&handleErrorElement(jQuery("#novalnet_invoice_due_date"),jQuery("#nn_invalid_due_date").val()),""!=jQuery.trim(jQuery("#novalnet_prepayment_due_date").val())&&(isNaN(jQuery("#novalnet_prepayment_due_date").val())||jQuery("#novalnet_prepayment_due_date").val()<7||jQuery("#novalnet_prepayment_due_date").val()>28)&&handleErrorElement(jQuery("#novalnet_prepayment_due_date"),jQuery("#nn_invalid_due_date").val()),jQuery.each(["#novalnet_instalment_invoice_min_amount","#novalnet_instalment_sepa_min_amount"],(function(e,n){""!=jQuery.trim(jQuery(n).val())&&(isNaN(jQuery(n).val())||jQuery(n).val()<1998)&&handleErrorElement(jQuery(n),jQuery("#nn_instalment_min_amount_error_text").val())})),jQuery.each(["#novalnet_guaranteed_invoice_min_amount","#novalnet_guaranteed_sepa_min_amount"],(function(e,n){""!=jQuery.trim(jQuery(n).val())&&(isNaN(jQuery(n).val())||jQuery(n).val()<999)&&handleErrorElement(jQuery(n),jQuery("#nn_guarantee_min_amount_error_text").val())})),jQuery.each(["#novalnet_cc_accepted_card_types","#novalnet_instalment_invoice_cycles","#novalnet_instalment_sepa_cycles"],(function(e,n){""==jQuery(n).val()&&handleErrorElement(jQuery(n),jQuery("#nn_multiselect_text").val())}))})),jQuery.each(["#novalnet_instalment_invoice_enablemode","#novalnet_instalment_sepa_enablemode"],(function(e,n){jQuery(n).closest(".nn-toggle-content").prepend('<div class="form-group nn_additional_content"><span class="nn_content">'+jQuery("#nn_instalment_payment_conditions").val()+"</span></div>")})),jQuery.each(["#novalnet_guaranteed_invoice_enablemode","#novalnet_guaranteed_sepa_enablemode"],(function(e,n){jQuery(n).closest(".nn-toggle-content").prepend('<div class="form-group nn_additional_content"><span class="nn_content">'+jQuery("#nn_guarantee_payment_conditions").val()+"</span></div>")})),jQuery("#novalnet_paypal_enablemode").closest(".nn-toggle-content").prepend('<div class="form-group nn_additional_content"><span class="nn_content">'+jQuery("#nn_paypal_api_configure").val()+"</span></div>"),jQuery("#novalnet_webhook_testmode").parent().parent().parent().parent().after('<div class="nn_webhook_notify">'+jQuery("#nn_webhook_notification").val()+"</div><br>")}));